
(is-type show-type
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity0
                         (c/ListConstraint [(c/ParamConstraint 'fn-arity0 0 empty-list 'x "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ParamConstraint 'fn-arity0 0 empty-list 'x ""))}
          empty-list 'show-type ""))

(is-type maybe
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity3
                         (c/ListConstraint [(c/ParamConstraint 'fn-arity3 0 empty-list 'v "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/ParamConstraint 'fn-arity3 0 empty-list 'v "")
                                            empty-list c/no-symbol ""))}
          empty-list 'maybe ""))

(is-type (maybe 9)
         (c/MaybeConstraint (c/IntegerConstraint 9 2147483647 -2147483648 empty-list c/no-symbol "")
                            empty-list c/no-symbol ""))

(is-type (maybe 'a)
         (c/MaybeConstraint (c/SymbolConstraint 'a empty-list c/no-symbol "")
                            empty-list c/no-symbol ""))

(is-type int-max
         (c/IntegerConstraint 2147483647 2147483647 -2147483648 empty-list c/no-symbol ""))

(is-type mutate-vect-conj
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity9
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity9 0 empty-list 'v "")
                                              c/vect-constraint]
                                             empty-list 'v "")
                                            (c/ParamConstraint 'fn-arity9 1 empty-list 'x "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint []
                                             (c/CollectionOf
                                              (c/SumConstraint
                                               [(c/ParamConstraint 'fn-arity9 1 empty-list 'x "")
                                                (c/ComputedConstraint
                                                  [(c/ParamConstraint 'fn-arity9 0 empty-list 'v "")
                                                   c/vect-constraint
                                                   c/inner-type-of]
                                                  empty-list 'v "")]
                                               empty-list c/no-symbol "")
                                              empty-list c/no-symbol "")
                                             empty-list 'result ""))}
          empty-list 'mutate-vect-conj ""))

(is-type (mutate-vect-conj ['x] 8)
         (c/VectorConstraint []
                             (c/CollectionOf
                              (c/SumConstraint
                               [(c/IntegerConstraint 8 2147483647 -2147483648 empty-list c/no-symbol "")
                                (c/SymbolConstraint 'x empty-list c/no-symbol "")]
                               empty-list c/no-symbol "")
                              empty-list c/no-symbol "") empty-list (symbol "#result") ""))

(is-type list-count
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity10
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity10 0 empty-list 'l "")
                                              (c/ListConstraint [] c/top-type empty-list 'l "")]
                                             empty-list 'l "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/IntegerConstraint c/no-int 2147483647 -2147483648 empty-list c/no-symbol ""))}
          empty-list 'list-count ""))

(is-type list-map
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity11
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity11 0 empty-list 'l "")
                                              (c/ListConstraint
                                               [] (c/CollectionOf
                                                   (c/ComputedConstraint
                                                    [(c/ParamConstraint 'fn-arity11 1 empty-list 'lf "")
                                                     (c/TypeOp c/arg-of-op 0 empty-list)]
                                                    empty-list 'lf "")
                                                   empty-list c/no-symbol "")
                                               empty-list 'l "")]
                                             empty-list 'l "")
                                            (c/ParamConstraint 'fn-arity11 1 empty-list 'lf "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ListConstraint
                          [] (c/CollectionOf
                              (c/ComputedConstraint
                               [(c/ParamConstraint 'fn-arity11 1 empty-list 'lf "")
                                c/result-of]
                               empty-list 'lf "")
                              empty-list c/no-symbol "")
                          empty-list c/no-symbol ""))}
          empty-list 'list-map ""))

(is-type (list-map '(1 a 3) (fn [x] x))
         (c/ListConstraint [] (c/CollectionOf
                               (c/SumConstraint
                                [(c/IntegerConstraint 1 2147483647 -2147483648 empty-list 'x "")
                                 (c/SymbolConstraint 'a empty-list c/no-symbol "")
                                 (c/IntegerConstraint 3 2147483647 -2147483648 empty-list 'x "")]
                                empty-list c/no-symbol "")
                               empty-list c/no-symbol "") empty-list c/no-symbol ""))

(is-type add-numbers
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity13
                         (c/ListConstraint
                          [(c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity13 0 empty-list 'x "")
                             (c/IntegerConstraint c/no-int 2147483647 -2147483648 empty-list 'x "")]
                            empty-list 'x "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity13 1 empty-list 'y "")
                             (c/IntegerConstraint c/no-int 2147483647 -2147483648 empty-list 'y "")]
                            empty-list 'y "")]
                          c/no-tail empty-list c/no-symbol "")
                         (c/IntegerConstraint c/no-int 2147483647 -2147483648 empty-list c/no-symbol ""))}
          empty-list 'add-numbers ""))

(is-type cons
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity28
                         (c/ListConstraint
                          [(c/ParamConstraint 'fn-arity28 0 empty-list 'x "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity28 1 empty-list 'l "")
                             (c/ListConstraint [] c/top-type empty-list 'l "")]
                            empty-list 'l "")]
                          c/no-tail empty-list c/no-symbol "")
                         (c/ListConstraint [(c/ParamConstraint 'fn-arity28 0 empty-list 'x "")]
                                           (c/ComputedConstraint
                                            [(c/ParamConstraint 'fn-arity28 1 empty-list 'l "")
                                             (c/ListConstraint [] c/top-type empty-list 'l "")]
                                            empty-list 'l "")
                                           empty-list 'result ""))}
          empty-list 'cons ""))

(is-type empty-list
         (c/ListConstraint [] c/no-tail empty-list 'empty-list ""))

(is-type (cons 'a empty-list)
         (c/ListConstraint [(c/SymbolConstraint 'a empty-list c/no-symbol "")]
                           c/no-tail empty-list c/no-symbol ""))

(is-type (cons 1 (cons 'a empty-list))
         (c/ListConstraint [(c/IntegerConstraint 1 2147483647 -2147483648 empty-list c/no-symbol "")
                            (c/SymbolConstraint 'a empty-list c/no-symbol "")]
                           c/no-tail empty-list c/no-symbol ""))

(is-type maybe-map
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity36
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity36 0 empty-list 'mv "")
                                              (c/MaybeConstraint
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'fn-arity36 1 empty-list 'mf "")
                                                 (c/TypeOp c/arg-of-op 0 empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list 'mv "")]
                                             empty-list 'mv "")
                                            (c/ParamConstraint 'fn-arity36 1 empty-list 'mf "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint
                          (c/ComputedConstraint
                           [(c/ParamConstraint 'fn-arity36 1 empty-list 'mf "")
                            (c/TypeOp c/call-value-op
                                      [(c/ComputedConstraint
                                        [(c/ParamConstraint 'fn-arity36 0 empty-list 'mv "")
                                         (c/MaybeConstraint
                                          (c/ComputedConstraint
                                           [(c/ParamConstraint 'fn-arity36 1 empty-list 'mf "")
                                            (c/TypeOp c/arg-of-op 0 empty-list)]
                                           empty-list c/no-symbol "")
                                          empty-list 'mv "")
                                         (c/TypeOp c/inner-type-of-op [] empty-list)]
                                        empty-list c/no-symbol "")] empty-list)]
                           empty-list c/no-symbol "")
                          empty-list 'mv ""))}
          empty-list 'maybe-map ""))

(is-type vector
         (c/FnConstraint
          []
          {c/variadic (c/fn-arity 'fn-arity95
                                  (c/ListConstraint []
                                                    (c/ComputedConstraint
                                                     [(c/ParamConstraint 'fn-arity95 0 empty-list 'l "")
                                                      (c/ListConstraint [] c/top-type empty-list c/no-symbol "")]
                                                     empty-list 'l "") empty-list c/no-symbol "")
                                  (c/ComputedConstraint
                                   [(c/ParamConstraint 'fn-arity95 0 empty-list 'l "")
                                    (c/ListConstraint [] c/top-type empty-list c/no-symbol "")
                                    (c/TypeOp c/vect-from-op [] empty-list)]
                                   empty-list 'l ""))}
          empty-list 'vector ""))

(is-type (maybe-map (maybe 3) vector)
         (c/MaybeConstraint
          (c/VectorConstraint
           [(c/IntegerConstraint 3 2147483647 -2147483648 empty-list c/no-symbol "")]
           c/no-tail empty-list c/no-symbol "")
          empty-list c/no-symbol ""))

(is-type ['x 'y 4]
         (c/VectorConstraint [(c/SymbolConstraint 'x empty-list c/no-symbol "")
                              (c/SymbolConstraint 'y empty-list c/no-symbol "")
                              (c/IntegerConstraint 4 2147483647 -2147483648
                                                   empty-list c/no-symbol "")]
                             c/no-tail empty-list c/no-symbol ""))

(is-type (maybe-map (maybe 's) (fn [x]
                                 (add-numbers 1 x)))
         c/bottom-type)

(is-type (maybe-map (maybe 8) (fn [x]
                                (add-numbers 1 x)))
         (c/MaybeConstraint (c/IntegerConstraint c/no-int 2147483647 -2147483648 empty-list c/no-symbol "")
                            empty-list c/no-symbol ""))

(is-type subs
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity44
                         (c/ListConstraint
                          [(c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity44 0 empty-list 'src "")
                             c/string-constraint]
                            empty-list 'src "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity44 1 empty-list 'index "")
                             (c/IntegerConstraint c/no-int 2147483647 0 empty-list c/no-symbol "")]
                            empty-list 'index "")]
                          c/no-tail empty-list c/no-symbol "")
                         (c/SubStrConstraint c/no-string empty-list c/no-symbol ""))
           3 (c/fn-arity 'fn-arity43
                         (c/ListConstraint
                          [(c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity43 0 empty-list 'src "")
                             c/string-constraint]
                            empty-list 'src "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity43 1 empty-list 'index "")
                             (c/IntegerConstraint c/no-int 2147483647 0 empty-list c/no-symbol "")]
                            empty-list 'index "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity43 2 empty-list 'length "")
                             (c/IntegerConstraint c/no-int 2147483647 0 empty-list c/no-symbol "")]
                            empty-list 'length "")]
                          c/no-tail empty-list c/no-symbol "")
                         (c/SubStrConstraint c/no-string empty-list c/no-symbol ""))}
          empty-list 'subs ""))

(is-type symbol
         (c/FnConstraint []
                         {1 (c/fn-arity 'fn-arity45
                                        (c/ListConstraint
                                         [(c/ComputedConstraint
                                           [(c/ParamConstraint 'fn-arity45 0 empty-list 'sym-str "")
                                            c/string-constraint]
                                           empty-list 'sym-str "")]
                                         c/no-tail empty-list c/no-symbol "")
                                        (c/SymbolConstraint c/no-symbol empty-list c/no-symbol ""))}
                         empty-list 'symbol ""))

(is-type future
         (c/FnConstraint []
                         {1 (c/fn-arity 'fn-arity49
                                        (c/ListConstraint [(c/ComputedConstraint
                                                            [(c/ParamConstraint 'fn-arity49 0 empty-list 'f "")
                                                             (.required-arities c/fn-constraint [0])]
                                                            empty-list 'f "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/FutureConstraint empty-list  c/no-symbol ""))
                          0 (c/fn-arity 'fn-arity50
                                        (c/ListConstraint [] c/no-tail empty-list c/no-symbol "")
                                        (c/FutureConstraint empty-list  c/no-symbol ""))}
                         empty-list 'future ""))

;; TODO put in after hash-maps are folded into ReifiedConstraint
;; (is-type (#impl hash-vec)
;;          (c/FnConstraint
;;           []
;;           {2 (c/fn-arity 'hash-vec
;;                          (c/ListConstraint
;;                           [(c/ComputedConstraint
;;                             [(c/ParamConstraint 'hash-vec 0 empty-list 'm "")
;;                              (c/SumConstraint
;;                               [(c/HashMapConstraint 11 {} c/top-type c/top-type empty-list c/no-symbol "")
;;                                (c/HashMapConstraint 12 {} c/top-type c/top-type empty-list c/no-symbol "")
;;                                (c/HashMapConstraint 13 {} c/top-type c/top-type empty-list c/no-symbol "")]
;;                               empty-list 'm "")]
;;                             empty-list 'm "")
;;                            (c/ComputedConstraint
;;                             [(c/ParamConstraint 'hash-vec 1 empty-list 'v "")
;;                              (c/VectorConstraint [] (c/CollectionOf c/top-type empty-list c/no-symbol "")
;;                                                  empty-list 'v "")]
;;                             empty-list 'v "")]
;;                           c/no-tail empty-list c/no-symbol "")
;;                          (c/VectorConstraint [] (c/CollectionOf c/top-type empty-list c/no-symbol "")
;;                                              empty-list c/no-symbol ""))}
;;           empty-list c/no-symbol ""))

(is-type comp
         (c/FnConstraint
          []
          {c/variadic (c/fn-arity 'fn-arity74
                                  (c/ListConstraint [(c/ParamConstraint 'fn-arity74 0 empty-list 'x "")]
                                                    (c/ComputedConstraint
                                                     [(c/ParamConstraint 'fn-arity74 1 empty-list 'xs "")
                                                      (c/ListConstraint [] c/top-type empty-list c/no-symbol "")
                                                      (c/SumConstraint
                                                       [(c/ListConstraint [] c/top-type empty-list c/no-symbol "")
                                                        c/vect-constraint]
                                                       empty-list 'Sequence "")]
                                                     empty-list 'xs "") empty-list c/no-symbol "")
                                  c/top-type)
           1 (c/fn-arity 'fn-arity75
                         (c/ListConstraint [(c/ParamConstraint 'fn-arity75 0 empty-list 'x "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ParamConstraint 'fn-arity75 0 empty-list 'x ""))}
          empty-list 'comp ""))

(is-type (#impl flat-map)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'flat-map
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'flat-map 0 empty-list 'x "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'flat-map 1 empty-list 'f "")
                                                 (.required-arities c/fn-constraint [1])
                                                 (c/TypeOp c/arg-of-op 0 empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list 'x "")]
                                             empty-list 'x "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'flat-map 1 empty-list 'f "")
                                              (.required-arities c/fn-constraint [1])]
                                             empty-list 'f "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [(c/ParamConstraint 'flat-map 1 empty-list 'f "")
                           (.required-arities c/fn-constraint [1])
                           (c/TypeOp c/call-value-op c/no-args empty-list)]
                          empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (#impl map)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'map
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'map 0 empty-list 'x "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'map 1 empty-list 'f "")
                                                 (c/TypeOp c/arg-of-op 0 empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list 'x "")]
                                             empty-list 'x "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'map 1 empty-list 'f "")
                                              (.required-arities c/fn-constraint [1])]
                                             empty-list 'f "")]
                                           c/no-tail empty-list c/no-symbol "")
                         c/top-type)
           3 (c/fn-arity 'map
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'map 0 empty-list 'x "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'map 1 empty-list 'f "")
                                                 (c/TypeOp c/arg-of-op 0 empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list 'x "")]
                                             empty-list 'x "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'map 1 empty-list 'f "")
                                              (.required-arities c/fn-constraint [1])]
                                             empty-list 'f "")
                                            (c/ParamConstraint 'map 2 empty-list 'embed "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/SumConstraint
                          [(c/ComputedConstraint
                            [(c/ParamConstraint 'map 2 empty-list 'embed "")
                             (c/TypeOp c/call-value-op c/no-args empty-list)]
                            empty-list c/no-symbol "")

                           (c/ComputedConstraint
                            [(c/ParamConstraint 'map 1 empty-list 'f "")
                             (.required-arities c/fn-constraint [1])
                             (c/TypeOp c/call-value-op c/no-args empty-list)]
                            empty-list c/no-symbol "")] empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (#impl extend)
         (c/FnConstraint []
                         {2 (c/fn-arity 'extend
                                        (c/ListConstraint [(c/ParamConstraint 'extend 0 empty-list 'x "")
                                                           (c/ComputedConstraint
                                                            [(c/ParamConstraint 'extend 1 empty-list 'f "")
                                                             (.required-arities c/fn-constraint [1])]
                                                            empty-list 'f "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        c/top-type)}
                         empty-list c/no-symbol ""))

(is-type (#impl extract)
         (c/FnConstraint []
                         {1 (c/fn-arity 'extract
                                        (c/ListConstraint [(c/ParamConstraint 'extract 0 empty-list 'x "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'extract 0 empty-list 'x "")
                                          c/inner-type-of]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl duplicate)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'duplicate
                         (c/ListConstraint [(c/ParamConstraint 'duplicate 0 empty-list 'x "")]
                                           c/no-tail empty-list c/no-symbol "")
                         c/top-type)}
          empty-list c/no-symbol ""))

(is-type Predicate
         (c/ComputedConstraint
          [(.required-arities c/fn-constraint [1])
           (c/intersect c/fn-constraint
                        (c/CollectionOf c/maybe-constraint empty-list c/no-symbol ""))]
          empty-list 'Predicate ""))

(defn tg [f y]
  ;; TODO: this shows the problem of intersecting two ComputedConstraints that have TypeOps
  ;; !returns (inner-type-of (type-of-result f))
  (extract (f y)))

;; TODO: put back in later
;; (is-type tg
;;          (c/FnConstraint
;;           []
;;           {2 (c/fn-arity 'fn-arity77
;;                          (c/ListConstraint [(c/ParamConstraint 'fn-arity77 0 empty-list 'f "")
;;                                             (c/ParamConstraint 'fn-arity77 1 empty-list 'y "")]
;;                                            c/no-tail empty-list c/no-symbol "")
;;                          (c/ComputedConstraint
;;                           [(c/ParamConstraint 'fn-arity77 0 empty-list 'f "")
;;                            (c/TypeOp c/call-value-op [(c/ParamConstraint 'fn-arity77 1 empty-list c/no-symbol "")]
;;                                      empty-list)
;;                            c/inner-type-of]
;;                           empty-list 'f ""))}
;;           empty-list 'tg ""))

(is-type (tg maybe 8)
         (c/ReifiedConstraint 1 'Integer
                              {}
                              {'min -2147483648 'max 2147483647 'static-value 8}
                              (c/FnConstraint [] {} empty-list c/no-symbol "")
                              empty-list  c/no-symbol ""))

(is-type (#impl filter)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'filter
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'filter 0 empty-list 'coll "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'filter 1 empty-list 'f "")
                                                 (.required-arities c/fn-constraint [1])
                                                 (c/intersect c/fn-constraint
                                                              (c/CollectionOf c/maybe-constraint
                                                                              empty-list c/no-symbol ""))
                                                 (c/TypeOp c/arg-of-op 0 empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list 'coll "")]
                                             empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'filter 1 empty-list 'f "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint
                                                                           empty-list c/no-symbol ""))]
                                             empty-list 'Predicate "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/CollectionOf
                          (c/ComputedConstraint
                           [(c/ParamConstraint 'filter 1 empty-list 'f "")
                            (.required-arities c/fn-constraint [1])
                            (c/intersect c/fn-constraint
                                         (c/CollectionOf c/maybe-constraint
                                                         empty-list c/no-symbol ""))
                            (c/TypeOp c/arg-of-op 0 empty-list)]
                           empty-list c/no-symbol "")
                          empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(defn tf [x]
  (instance? Symbol x))

(is-type (#impl reduce)
         (c/FnConstraint
          []
          {3 (c/fn-arity 'reduce
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'reduce 0 empty-list 'coll "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'reduce 2 empty-list 'f "")
                                                 (.required-arities c/fn-constraint [2])
                                                 (c/TypeOp c/arg-of-op 1 empty-list )]
                                                empty-list c/no-symbol "")
                                               empty-list 'coll "")]
                                             empty-list 'coll "")
                                            (c/ParamConstraint 'reduce 1 empty-list 'x "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'reduce 2 empty-list 'f "")
                                              (.required-arities c/fn-constraint [2])]
                                             empty-list 'f "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/SumConstraint
                          [(c/ParamConstraint 'reduce 1 empty-list 'x "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'reduce 2 empty-list 'f "")
                             (.required-arities c/fn-constraint [2])
                             (c/TypeOp c/call-value-op c/no-args empty-list )]
                            empty-list c/no-symbol "")]
                          empty-list 'result ""))}
          empty-list c/no-symbol ""))

(is-type (#impl seq)
         (c/FnConstraint []
                         {1 (c/fn-arity 'seq
                                        (c/ListConstraint [(c/ParamConstraint 'seq 0 empty-list 'coll "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'seq 0 empty-list 'coll "")
                                          (c/TypeOp c/list-from-op [] empty-list )]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl vec)
         (c/FnConstraint []
                         {1 (c/fn-arity 'vec
                                        (c/ListConstraint [(c/ParamConstraint 'vec 0 empty-list 'coll "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'vec 0 empty-list 'coll "")
                                          (c/TypeOp c/vect-from-op [] empty-list)]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl first)
         (c/FnConstraint []
                         {1 (c/fn-arity 'first
                                        (c/ListConstraint [(c/ParamConstraint 'first 0 empty-list 'coll "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'first 0 empty-list 'coll "")
                                          (c/TypeOp c/first-of-op [] empty-list)]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl last)
         (c/FnConstraint []
                         {1 (c/fn-arity 'last
                                        (c/ListConstraint [(c/ParamConstraint 'last 0 empty-list 'coll "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'last 0 empty-list 'coll "")
                                          (c/TypeOp c/last-of-op [] empty-list)]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl rest)
         (c/FnConstraint []
                         {1 (c/fn-arity 'rest
                                        (c/ListConstraint [(c/ParamConstraint 'rest 0 empty-list 'coll "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'rest 0 empty-list 'coll "")
                                          (c/TypeOp c/rest-of-op [] empty-list)]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl butlast)
         (c/FnConstraint []
                         {1 (c/fn-arity 'butlast
                                        (c/ListConstraint [(c/ParamConstraint 'butlast 0 empty-list 'coll "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'butlast 0 empty-list 'coll "")
                                          (c/TypeOp c/butlast-of-op [] empty-list)]
                                         empty-list 'result ""))}
                         empty-list c/no-symbol ""))

(is-type (#impl split)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'split
                         (c/ListConstraint [(c/ParamConstraint 'split 0 empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'split 1 empty-list 'n "")
                                              (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                                                   empty-list c/no-symbol "")]
                                             empty-list 'n "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint [(c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'split 0 empty-list 'coll "")
                                                 c/inner-type-of]
                                                empty-list c/no-symbol "")
                                               empty-list c/no-symbol "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'split 0 empty-list 'coll "")
                                                 c/inner-type-of]
                                                empty-list c/no-symbol "")
                                               empty-list c/no-symbol "")]
                                             c/no-tail
                                             empty-list 'result ""))}
          empty-list c/no-symbol ""))

(is-type (#impl split-with)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'split-with
                         (c/ListConstraint [(c/ParamConstraint 'split-with 0 empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'split-with 1 empty-list 'pred "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list 'Predicate "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint [(c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'split-with 0 empty-list 'coll "")
                                                 (c/TypeOp c/inner-type-of-op [] empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list c/no-symbol "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'split-with 0 empty-list 'coll "")
                                                 (c/TypeOp c/inner-type-of-op [] empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list c/no-symbol "")]
                                             c/no-tail empty-list (symbol "#result") ""))
           3 (c/fn-arity 'split-with
                         (c/ListConstraint [(c/ParamConstraint 'split-with 0 empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'split-with 1 empty-list 'pred "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list 'Predicate "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'split-with 2 empty-list 'prefix "")
                                              c/seq-constraint]
                                             empty-list 'prefix "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint [(c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'split-with 0 empty-list 'coll "")
                                                 (c/TypeOp c/inner-type-of-op [] empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list c/no-symbol "")
                                              (c/CollectionOf
                                               (c/ComputedConstraint
                                                [(c/ParamConstraint 'split-with 0 empty-list 'coll "")
                                                 (c/TypeOp c/inner-type-of-op [] empty-list)]
                                                empty-list c/no-symbol "")
                                               empty-list c/no-symbol "")]
                                             c/no-tail empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (#impl drop-while)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'drop-while
                         (c/ListConstraint [(c/ParamConstraint 'drop-while 0 empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'drop-while 1 empty-list 'pred "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list 'Predicate "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/CollectionOf
                          (c/ComputedConstraint
                           [(c/ParamConstraint 'drop-while 0 empty-list 'coll "")
                            c/inner-type-of]
                           empty-list c/no-symbol "")
                          empty-list 'result ""))}
          empty-list c/no-symbol ""))

(is-type (#impl reverse)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'reverse
                         (c/ListConstraint [(c/ParamConstraint 'reverse 0 empty-list 'coll "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/CollectionOf
                          (c/ComputedConstraint
                           [(c/ParamConstraint 'reverse 0 empty-list 'coll "")
                            c/inner-type-of]
                           empty-list c/no-symbol "")
                          empty-list 'result ""))}
          empty-list c/no-symbol ""))

(is-type second
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity77
                         (c/ListConstraint [(c/ParamConstraint 'fn-arity77 0 empty-list 'coll "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [(c/ParamConstraint 'fn-arity77 0 empty-list 'coll "")
                           (c/TypeOp c/rest-of-op [] empty-list)
                           (c/TypeOp c/first-of-op [] empty-list)]
                          empty-list 'coll ""))}
          empty-list 'second ""))

(is-type (#impl store)
         (c/FnConstraint
          []
          {3 (c/fn-arity 'store
                         (c/ListConstraint [(c/ParamConstraint 'store 0 empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'store 1 empty-list 'n "")
                                              (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                                                   empty-list c/no-symbol "")]
                                             empty-list 'n "")
                                            (c/ParamConstraint 'store 2 empty-list 'v "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/SumConstraint
                                             [(c/ComputedConstraint
                                               [(c/ParamConstraint 'store 0 empty-list 'coll "")
                                                c/inner-type-of]
                                               empty-list c/no-symbol "")
                                              (c/ParamConstraint 'store 2 empty-list 'v "")]
                                             empty-list c/no-symbol "")
                                            empty-list 'result ""))}
          empty-list c/no-symbol ""))

(is-type list-reduce
         (c/FnConstraint
          []
          {3 (c/fn-arity 'fn-arity78
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity78 0 empty-list 'l "")
                                              (c/ListConstraint []
                                                                (c/CollectionOf
                                                                 (c/ComputedConstraint
                                                                  [(c/ParamConstraint 'fn-arity78 2 empty-list 'f "")
                                                                   (c/TypeOp c/arg-of-op 1 empty-list)]
                                                                  empty-list c/no-symbol "")
                                                                 empty-list c/no-symbol "") empty-list 'l "")]
                                             empty-list 'l "")
                                            (c/ParamConstraint 'fn-arity78 1 empty-list 'result "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity78 2 empty-list 'f "")
                                              (.required-arities c/fn-constraint [2])]
                                             empty-list 'f "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/SumConstraint
                          [(c/ParamConstraint 'fn-arity78 1 empty-list 'result "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity78 2 empty-list 'f "")
                             (.required-arities c/fn-constraint [2])
                             (c/TypeOp c/call-value-op c/no-args empty-list)]
                            empty-list c/no-symbol "")]
                          empty-list (symbol "#result") ""))}
          empty-list 'list-reduce ""))

(is-type (#impl =* List)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity77
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity77 0 empty-list 'x "")
                                              (c/ListConstraint [] c/top-type empty-list 'x "")]
                                             empty-list 'x "")
                                            (c/ParamConstraint 'fn-arity77 1 empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/ParamConstraint 'fn-arity77 0 empty-list c/no-symbol "")
                                            empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (#impl filter List)
         (c/FnConstraint
          []
          {2 (c/fn-arity
              'fn-arity84
              (c/ListConstraint [(c/ComputedConstraint
                                  [(c/ParamConstraint 'fn-arity84 0 empty-list c/no-symbol "")
                                   (c/ListConstraint
                                    [] (c/CollectionOf
                                        (c/ComputedConstraint
                                         [(c/ParamConstraint 'fn-arity84 1 empty-list c/no-symbol "")
                                          (.required-arities c/fn-constraint [1])
                                          (c/intersect c/fn-constraint
                                                       (c/CollectionOf c/maybe-constraint
                                                                       empty-list c/no-symbol ""))
                                          (c/TypeOp c/arg-of-op 0 empty-list)]
                                         empty-list c/no-symbol "")
                                        empty-list 'coll "") empty-list c/no-symbol "")]
                                  empty-list c/no-symbol "")
                                 (c/ComputedConstraint
                                  [(c/ParamConstraint 'fn-arity84 1 empty-list c/no-symbol "")
                                   (.required-arities c/fn-constraint [1])
                                   (c/intersect c/fn-constraint
                                                (c/CollectionOf c/maybe-constraint
                                                                empty-list c/no-symbol ""))]
                                  empty-list c/no-symbol "")]
                                c/no-tail empty-list c/no-symbol "")
              (c/ListConstraint
               [] (c/CollectionOf
                   (c/ComputedConstraint
                    [(c/ParamConstraint 'fn-arity84 1 empty-list c/no-symbol "")
                     (.required-arities c/fn-constraint [1])
                     (c/intersect c/fn-constraint
                                  (c/CollectionOf c/maybe-constraint
                                                  empty-list c/no-symbol ""))
                     (c/TypeOp c/arg-of-op 0 empty-list)]
                    empty-list c/no-symbol "")
                   empty-list (symbol "#result") "") empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (#impl reverse List)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity78
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity78 0 empty-list 'l "")
                                              (c/ListConstraint []
                                                                c/top-type empty-list 'l "")]
                                             empty-list 'l "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ListConstraint
                          [] (c/CollectionOf
                              (c/ComputedConstraint
                               [(c/ParamConstraint 'fn-arity78 0 empty-list c/no-symbol "")
                                c/inner-type-of]
                               empty-list c/no-symbol "")
                              empty-list (symbol "#result") "")
                                           empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (#impl rest List)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity81
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity81 0 empty-list 'l "")
                                              (c/ListConstraint []
                                                                c/top-type empty-list 'l "")]
                                             empty-list 'l "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [(c/ParamConstraint 'fn-arity81 0 empty-list c/no-symbol "")
                           (c/TypeOp c/rest-of-op [] empty-list)]
                          empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (rest '(a b c))
         (c/ListConstraint [(c/SymbolConstraint 'b empty-list c/no-symbol "")
                            (c/SymbolConstraint 'c empty-list c/no-symbol "")]
                           c/no-tail empty-list c/no-symbol ""))

(is-type (#impl vec List)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity80
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity80 0 empty-list 'l "")
                                              (c/ListConstraint []
                                                                c/top-type empty-list 'l "")]
                                             empty-list 'l "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [(c/ParamConstraint 'fn-arity80 0 empty-list 'l "")
                           (c/ListConstraint []
                                             c/top-type empty-list 'l "")
                           (c/TypeOp c/vect-from-op [] empty-list)]
                          empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (vec (list 'a 'b 'c))
         (c/VectorConstraint [(c/SymbolConstraint 'a empty-list c/no-symbol "")
                              (c/SymbolConstraint 'b empty-list c/no-symbol "")
                              (c/SymbolConstraint 'c empty-list c/no-symbol "")]
                             c/no-tail empty-list c/no-symbol ""))

(is-type ['x 'y 4]
         (c/VectorConstraint [(c/SymbolConstraint 'x empty-list c/no-symbol "")
                              (c/SymbolConstraint 'y empty-list c/no-symbol "")
                              (c/IntegerConstraint 4 2147483647 -2147483648
                                                   empty-list c/no-symbol "")]
                             c/no-tail empty-list c/no-symbol ""))

(is-type (seq ['a 'b 'c])
         (c/ListConstraint [(c/SymbolConstraint 'a empty-list c/no-symbol "")
                            (c/SymbolConstraint 'b empty-list c/no-symbol "")
                            (c/SymbolConstraint 'c empty-list c/no-symbol "")]
                           c/no-tail empty-list c/no-symbol ""))

(is-type (#impl reverse Vector)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity83
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity83 0 empty-list 'v "")
                                              c/vect-constraint]
                                             empty-list 'v "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint []
                                             (c/CollectionOf
                                              (c/ComputedConstraint
                                               [(c/ParamConstraint 'fn-arity83 0 empty-list c/no-symbol "")
                                                c/inner-type-of]
                                               empty-list c/no-symbol "")
                                              empty-list (symbol "#result") "") empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (#impl store Vector)
         (c/FnConstraint
          []
          {3 (c/fn-arity 'fn-arity86
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity86 0 empty-list 'v "")
                                              c/vect-constraint]
                                             empty-list 'v "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity86 1 empty-list c/no-symbol "")
                                              (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                                                   empty-list c/no-symbol "")]
                                             empty-list c/no-symbol "")
                                            (c/ParamConstraint 'fn-arity86 2 empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/SumConstraint
                                             [(c/ComputedConstraint
                                               [(c/ParamConstraint 'fn-arity86 0 empty-list c/no-symbol "")
                                                c/inner-type-of]
                                               empty-list c/no-symbol "")
                                              (c/ParamConstraint 'fn-arity86 2 empty-list c/no-symbol "")]
                                             empty-list c/no-symbol "")
                                            empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (#impl get Vector)
         (c/FnConstraint []
                         {2 (c/fn-arity 'fn-arity85
                                        (c/ListConstraint [(c/ComputedConstraint
                                                            [(c/ParamConstraint 'fn-arity85 0 empty-list 'v "")
                                                             c/vect-constraint]
                                                            empty-list 'v "")
                                                           (c/ComputedConstraint
                                                            [(c/ParamConstraint 'fn-arity85 1 empty-list 'n "")
                                                             (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                                                                  empty-list c/no-symbol "")]
                                                            empty-list 'n "")]
                                                          c/no-tail empty-list c/no-symbol "")
                                        (c/MaybeConstraint (c/ComputedConstraint
                                                            [(c/ParamConstraint 'fn-arity85 0 empty-list 'v "")
                                                             c/vect-constraint
                                                             c/inner-type-of]
                                                            empty-list c/no-symbol "")
                                                           empty-list c/no-symbol ""))}
                         empty-list c/no-symbol ""))

(is-type (get ['a 1 "b"] 8)
         (c/MaybeConstraint (c/SumConstraint
                             [(c/SymbolConstraint 'a empty-list c/no-symbol "")
                              (c/IntegerConstraint 1 2147483647 -2147483648
                                                   empty-list c/no-symbol "")
                              (c/StrBuffConstraint "b" empty-list c/no-symbol "")]
                             empty-list c/no-symbol "")
                            empty-list c/no-symbol ""))

(is-type (#impl =* Integer)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity95
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity95 0 empty-list 'x "")
                                              (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                                                   empty-list c/no-symbol "")]
                                             empty-list 'x "")
                                            (c/ParamConstraint 'fn-arity95 1 empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/ParamConstraint 'fn-arity95 0 empty-list c/no-symbol "")
                                            empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type inc
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity101
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity101 0 empty-list 'x "")
                                              (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                                                   empty-list c/no-symbol "")]
                                             empty-list 'x "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/IntegerConstraint c/no-int 2147483647 -2147483648
                                              empty-list c/no-symbol ""))}
          empty-list 'inc ""))

;; TODO: this kind of sucks
(is-type (comp "a" "bc ")
         c/top-type)

(is-type (#impl reduce StringBuffer)
         (c/FnConstraint
          []
          {3 (c/fn-arity 'fn-arity161
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity161 0 empty-list c/no-symbol "")
                                              (c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity161 2 empty-list c/no-symbol "")
                                                (.required-arities c/fn-constraint [2])
                                                (c/TypeOp c/arg-of-op 1 empty-list)]
                                               empty-list c/no-symbol "")]
                                             empty-list c/no-symbol "")
                                            (c/ParamConstraint 'fn-arity161 1 empty-list 'x "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity161 2 empty-list c/no-symbol "")
                                              (.required-arities c/fn-constraint [2])]
                                             empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/SumConstraint
                          [(c/ParamConstraint 'fn-arity161 1 empty-list c/no-symbol "")
                           (c/ComputedConstraint
                            [(c/ParamConstraint 'fn-arity161 2 empty-list c/no-symbol "")
                             (.required-arities c/fn-constraint [2])
                             (c/TypeOp c/call-value-op c/no-args empty-list)]
                            empty-list c/no-symbol "")] empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (#impl seq StringBuffer)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity111
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity111 0 empty-list 'coll "")
                                              c/strbuff-constraint]
                                             empty-list 'coll "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [(c/ParamConstraint 'fn-arity111 0 empty-list 'coll "")
                           c/strbuff-constraint
                           (c/TypeOp c/list-from-op [] empty-list)]
                          empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (seq "abc")
         (c/ListConstraint [(c/SubStrConstraint "a" empty-list c/no-symbol "")
                            (c/SubStrConstraint "b" empty-list c/no-symbol "")
                            (c/SubStrConstraint "c" empty-list c/no-symbol "")]
                           c/no-tail empty-list c/no-symbol ""))

(is-type (first "abc")
         (c/MaybeConstraint c/string-constraint
                            empty-list c/no-symbol ""))

(is-type (rest "abc")
         c/substr-constraint)

(is-type (last "abc")
         (c/MaybeConstraint c/string-constraint
                            empty-list c/no-symbol ""))

(is-type (butlast "abc")
         c/substr-constraint)

(is-type (#impl reverse StringBuffer)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity113
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity113 0 empty-list 's "")
                                              c/strbuff-constraint]
                                             empty-list 's "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [c/string-constraint
                           (c/ParamConstraint 'fn-arity113 0 empty-list c/no-symbol "")
                           (c/TypeOp c/inner-type-of-op [] empty-list)]
                          empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (reverse "123")
         (c/SumConstraint
          [(c/StrBuffConstraint "1" empty-list c/no-symbol "")
           (c/StrBuffConstraint "2" empty-list c/no-symbol "")
           (c/StrBuffConstraint "3" empty-list c/no-symbol "")]
          empty-list c/no-symbol ""))

(is-type (#impl split-with StringBuffer)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity135
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity135 0 empty-list 's "")
                                              c/strbuff-constraint
                                              c/string-constraint]
                                             empty-list 's "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity135 1 empty-list c/no-symbol "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint [(c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity135 0 empty-list 's "")
                                                c/strbuff-constraint
                                                (c/TypeOp c/inner-type-of-op [] empty-list)
                                                (c/CollectionOf
                                                 (c/ComputedConstraint
                                                  [(c/ParamConstraint 'fn-arity135 0 empty-list c/no-symbol "")
                                                   (c/TypeOp c/inner-type-of-op [] empty-list)]
                                                  empty-list c/no-symbol "")
                                                 empty-list c/no-symbol "")]
                                               empty-list 's "")
                                              (c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity135 0 empty-list 's "")
                                                c/strbuff-constraint
                                                (c/TypeOp c/inner-type-of-op [] empty-list)
                                                (c/CollectionOf
                                                 (c/ComputedConstraint
                                                  [(c/ParamConstraint 'fn-arity135 0 empty-list c/no-symbol "")
                                                   (c/TypeOp c/inner-type-of-op [] empty-list)]
                                                  empty-list c/no-symbol "")
                                                 empty-list c/no-symbol "")]
                                               empty-list 's "")]
                                             c/no-tail empty-list (symbol "#result") ""))
           3 (c/fn-arity 'fn-arity129
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity129 0 empty-list 's "")
                                              c/strbuff-constraint
                                              c/string-constraint]
                                             empty-list 's "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity129 1 empty-list c/no-symbol "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list c/no-symbol "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity129 2 empty-list c/no-symbol "")
                                              c/vect-constraint]
                                             empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint [(c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity129 0 empty-list c/no-symbol "")
                                                (c/TypeOp c/inner-type-of-op [] empty-list)]
                                               empty-list c/no-symbol "")
                                              (c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity129 0 empty-list c/no-symbol "")
                                                (c/TypeOp c/inner-type-of-op [] empty-list)]
                                               empty-list c/no-symbol "")]
                                             c/no-tail empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (split-with "8815" (partial =* 8))
         (c/VectorConstraint [(c/SumConstraint
                               [(c/StrBuffConstraint "8" empty-list c/no-symbol "")
                                (c/StrBuffConstraint "1" empty-list c/no-symbol "")
                                (c/StrBuffConstraint "5" empty-list c/no-symbol "")]
                               empty-list c/no-symbol "")
                              (c/SumConstraint
                               [(c/StrBuffConstraint "8" empty-list c/no-symbol "")
                                (c/StrBuffConstraint "1" empty-list c/no-symbol "")
                                (c/StrBuffConstraint "5" empty-list c/no-symbol "")]
                               empty-list c/no-symbol "")]
                             c/no-tail
                             empty-list (symbol "#result") ""))

(is-type (#impl split SubString)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity112
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity112 0 empty-list 's "")
                                              c/substr-constraint
                                              c/string-constraint]
                                             empty-list 's "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity112 1 empty-list c/no-symbol "")
                                              (c/IntegerConstraint c/no-int 2147483647 0
                                                                   empty-list c/no-symbol "")]
                                             empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/VectorConstraint [(c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity112 0 empty-list c/no-symbol "")
                                                (c/TypeOp c/inner-type-of-op [] empty-list)]
                                               empty-list c/no-symbol "")
                                              (c/ComputedConstraint
                                               [c/string-constraint
                                                (c/ParamConstraint 'fn-arity112 0 empty-list c/no-symbol "")
                                                (c/TypeOp c/inner-type-of-op [] empty-list)]
                                               empty-list c/no-symbol "")]
                                             c/no-tail empty-list (symbol "#result") ""))}
          empty-list c/no-symbol ""))

(is-type (#impl nth SubString)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity159
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity159 0 empty-list 's "")
                                              c/substr-constraint
                                              c/string-constraint]
                                             empty-list 's "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity159 1 empty-list 'n "")
                                              (c/IntegerConstraint c/no-int 2147483647 0
                                                                   empty-list c/no-symbol "")]
                                             empty-list 'n "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity159 0 empty-list c/no-symbol "")
                                              (c/TypeOp c/inner-type-of-op [] empty-list)]
                                             empty-list c/no-symbol "")
                                            empty-list c/no-symbol ""))}
          empty-list c/no-symbol ""))

(is-type (#impl drop-while StringBuffer)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity169
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity169 0 empty-list 'coll "")
                                              c/strbuff-constraint
                                              c/string-constraint]
                                             empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity169 1 empty-list c/no-symbol "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [c/string-constraint
                           (c/ParamConstraint 'fn-arity169 0 empty-list 'coll "")
                           c/strbuff-constraint
                           (c/TypeOp c/inner-type-of-op [] empty-list)
                           (c/CollectionOf
                            (c/ComputedConstraint
                             [(c/ParamConstraint 'fn-arity169 0 empty-list 'coll "")
                              c/strbuff-constraint
                              (c/TypeOp c/inner-type-of-op [] empty-list)]
                             empty-list 'coll "")
                            empty-list c/no-symbol "")
                           (c/CollectionOf
                            (c/ComputedConstraint
                             [(c/ParamConstraint 'fn-arity169 0 empty-list c/no-symbol "")
                              (c/TypeOp c/inner-type-of-op [] empty-list)]
                             empty-list c/no-symbol "")
                            empty-list (symbol "#result") "")]
                          empty-list 'coll ""))}
          empty-list c/no-symbol ""))

(is-type (drop-while "884412" (partial =* "8"))
         (c/SumConstraint
          [(c/StrBuffConstraint "8" empty-list c/no-symbol "")
           (c/StrBuffConstraint "4" empty-list c/no-symbol "")
           (c/StrBuffConstraint "1" empty-list c/no-symbol "")
           (c/StrBuffConstraint "2" empty-list c/no-symbol "")]
          empty-list c/no-symbol ""))

(is-type (drop-while (subs "884412" 1) (partial =* "8"))
         c/string-constraint)

(is-type (#impl take-while StringBuffer)
         (c/FnConstraint
          []
          {2 (c/fn-arity 'fn-arity171
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity171 0 empty-list 'coll "")
                                              c/strbuff-constraint
                                              c/string-constraint]
                                             empty-list 'coll "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity171 1 empty-list c/no-symbol "")
                                              (.required-arities c/fn-constraint [1])
                                              (c/intersect c/fn-constraint
                                                           (c/CollectionOf c/maybe-constraint empty-list
                                                                           c/no-symbol ""))]
                                             empty-list c/no-symbol "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [c/string-constraint
                           (c/ParamConstraint 'fn-arity171 0 empty-list 'coll "")
                           c/strbuff-constraint
                           (c/TypeOp c/inner-type-of-op [] empty-list)
                           (c/CollectionOf
                            (c/ComputedConstraint
                             [(c/ParamConstraint 'fn-arity171 0 empty-list 'coll "")
                              c/strbuff-constraint
                              (c/TypeOp c/inner-type-of-op [] empty-list)]
                             empty-list 'coll "")
                            empty-list c/no-symbol "")
                           (c/CollectionOf
                            (c/ComputedConstraint
                             [(c/ParamConstraint 'fn-arity171 0 empty-list c/no-symbol "")
                              (c/TypeOp c/inner-type-of-op [] empty-list)]
                             empty-list c/no-symbol "")
                            empty-list (symbol "#result") "")]
                          empty-list 'coll ""))}
          empty-list c/no-symbol ""))

(is-type (take-while "884412" (partial =* "8"))
         (c/SumConstraint
          [(c/StrBuffConstraint "8" empty-list c/no-symbol "")
           (c/StrBuffConstraint "4" empty-list c/no-symbol "")
           (c/StrBuffConstraint "1" empty-list c/no-symbol "")
           (c/StrBuffConstraint "2" empty-list c/no-symbol "")]
          empty-list c/no-symbol ""))

(is-type (take-while (subs "884412" 1) (partial =* "8"))
         c/string-constraint)

(is-type (#impl to-str StringBuffer)
         (c/FnConstraint
          []
          {1 (c/fn-arity 'fn-arity173
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity173 0 empty-list 's "")
                                              c/strbuff-constraint]
                                             empty-list 's "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/ComputedConstraint
                          [(c/ParamConstraint 'fn-arity173 0 empty-list 's "")
                           c/strbuff-constraint]
                          empty-list 's ""))}
          empty-list c/no-symbol ""))

(is-type maybe-apply
         (c/FnConstraint
          []
          {3 (c/fn-arity 'fn-arity175
                         (c/ListConstraint [(c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity175 0 empty-list 'mv "")
                                              c/maybe-constraint]
                                             empty-list 'mv "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity175 1 empty-list 'm-args "")
                                              (c/intersect c/seq-constraint
                                                           (c/CollectionOf c/maybe-constraint
                                                                           empty-list c/no-symbol ""))]
                                             empty-list 'm-args "")
                                            (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity175 2 empty-list 'args "")
                                              c/vect-constraint]
                                             empty-list 'args "")]
                                           c/no-tail empty-list c/no-symbol "")
                         (c/MaybeConstraint (c/ComputedConstraint
                                             [(c/ParamConstraint 'fn-arity175 0 empty-list 'mv "")
                                              c/maybe-constraint
                                              (c/TypeOp c/inner-type-of-op [] empty-list)
                                              (c/TypeOp c/call-value-op c/no-args empty-list)]
                                             empty-list c/no-symbol "")
                                            empty-list c/no-symbol ""))}
          empty-list 'maybe-apply ""))

(is-type (maybe-apply (maybe inc) (list (maybe 8)) [])
         (c/MaybeConstraint c/int-constraint empty-list c/no-symbol ""))

;; (is-type (#impl type-args Maybe)
;;          c/top-type)

;; (is-type (type-args (maybe 9))
;;          c/top-type)

;; TODO: put in later after map for List is defined
;; (is-type (map '(1 2 3) inc)
;;          c/top-type)
