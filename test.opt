
(defn id [x]
  x)

(def succ (fn [n]
            (fn [inc]
              (fn [base]
                (inc ((n inc) base))))))

(def mult (fn [n]
            (fn [m]
              (fn [a]
                (n (m a))))))

(def pair (fn [l]
            (fn [r]
              (fn [z]
                ((z l) r)))))

(def fst (fn [ff]
           (fn [fs]
             ff)))

(def snd (fn [ff]
           (fn [fs]
             fs)))

(def nextfact (fn [pr]
                ((pair ((mult (pr fst)) (succ (pr snd))))
                 (succ (pr snd)))))

(def fact (fn [nf]
            (((nf nextfact) ((pair 1) 0)) fst)))

(((fact 3) succ) 0)

